in â† âˆ¾â€¢FLines"3.in"
S  â† (âŠ¢-Ëœ+`Ã—Â¬)âˆ˜=âŠ”âŠ¢

# split input from "mul("
# if the instruction is valid, the resulting string
# starts with "d,d)", where d is a digit
m â† (+`Â·Â»âŸ4â‰ â†‘"mul("âŠ¸â·)âŠ¸âŠ”in

# only use strings that have ,) in them
valid â† âŸ¨âŸ©âŠ¸â‰¢Â¨âŠ¸/{1â€¿1â‰¡",)"âˆŠğ•©}âŠ¸/Â¨m

# Split from ) and parse each side of ,
# Multiply and sum each pair
Star â† {+Â´Ã—Â´Â¨','â€¢ParseFloatâŠ0Â¨âˆ˜SÂ¨')'âŠ‘âˆ˜SÂ¨ğ•©}

# Build a mask for filtering
Mark â† {Â»+Â´Â¨ğ•¨âŠ¸â·Â¨ğ•©}

# Build the do/don't mask imperatively
# Could not figure out an array'y solution for this
do     â† 1
domask â† {1ğ•Š0: doâ†©1; 0ğ•Š1: doâ†©0; 0ğ•Š0: do}Â´Ë˜â‰>MarkâŸœvalidÂ¨"do()"â€¿"don't()"

star1 â† Star valid
star2 â† Star domask/valid
