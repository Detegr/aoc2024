d:{_[0,&~["";]'x;x]}@0:"5.in"
m:{_%[#x;2]}
n:{`p@{z/y\x}[x;y;" "]}
r:{n[x;"|"]}'*d
p:{n[x;","]}'1_d@1
or:{<(x{+/~[x,y;]'r}/:\:)'x}@'p
c:{x~x@<x}'or

+/{x@m x}'{c}#p           / star1
+/{x@m x}'@'/{~c}#'(p;or) / star2
