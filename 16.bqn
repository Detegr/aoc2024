# Modified from my ugly AoC 2021 day 15 solution
# Getting tedious, not having much fun anymore, I guess this was it for this year

If â† {ğ•âŸğ•@}Â´
in â† >â€¢FLines"16.in.big"
i  â† â†•â‰¢in
N  â† {/â—‹â¥ŠâŸœ(â†•â‰¢) iâˆŠğ•©âŠ¸+Â¨âŸ¨Â¯1â€¿0,1â€¿0,0â€¿Â¯1,0â€¿1âŸ©}

upâ€¿rightâ€¿downâ€¿left â† 1+â†•4

IsUp    â† {y1â€¿x1ğ•Šy2â€¿x2: y2<y1}
IsDown  â† {y1â€¿x1ğ•Šy2â€¿x2: y2>y1}
IsRight â† {y1â€¿x1ğ•Šy2â€¿x2: x2>x1}
IsLeft  â† {y1â€¿x1ğ•Šy2â€¿x2: x2<x1}
Dir     â† {ğ•¨ IsUp ğ•© ? up ; ğ•¨ IsDown ğ•© ? down ; ğ•¨ IsRight ğ•© ? right ; ğ•¨ IsLeft ğ•© ? left ; 0}

in â†© 99999999Ã—Â¬Ã—(â·â¥Šin)âŠin
sâ†â‰¢in
mâ†sâ¥Š1
tgtâ†(2-ËœâŠ‘â‰¢in)â€¿1
curâ†1â€¿(2-Ëœ1âŠ‘â‰¢in)
csâ†âŸ¨âŸ©
csdâ†âŸ¨âŸ©
uâ†0âŒ¾(curâŠ¸âŠ‘)sâ¥Šâˆ

# ultra stupid, only works by testing what gives the best result for this input
d â† down

Step â† {ğ•¤
  neigâ†N cur
  neigâ†©(0â‰ neigâŠ‘m)/neig
  If (â‰ neig)â€¿{ğ•¤
    csâ†©neigâˆ¾cs
    csdâ†©(curâŠ¸DirÂ¨neig)âˆ¾csd
    uâ†©{ğ•¤
      iâ†neigâŠ‘in
      câ†curâŠ‘u
      i â†© 1+i+1000Ã—d â‰  curâŠ¸DirÂ¨neig
      {ğ•Šinpâ€¿u: (uâŒŠc+inp)}Ë˜â‰iâ‰ğ•©
    }âŒ¾(neigâŠ¸âŠ‘) u
  }
  csi    â† âŠ‘â‹csâŠ‘u
  newcur â† csiâŠ‘cs
  d      â†© csiâŠ‘csd
  m   â†© 0âŒ¾(curâŠ¸âŠ‘) m
  cur â†© newcur
  csm â† (<cur)â‰¢Â¨cs
  cs  â†© csm/cs
  csd â†© csm/csd
  tgtâŠ‘u
}

star1 â† Stepâˆ˜@â€¢_while_(=âŸœâˆ) âˆ
