I  ← {•ParseFloat¨((¯1+⊢×·+`»⊸<)𝕩∊'-'∾'0'+↕10)⊔𝕩}
in ← >I¨•FLines"14.in.real"
sz ← 101‿103 # for real input
#sz ← 11‿7     # for example input
h  ← ⌊sz÷2
M  ← {𝕊x‿y‿dx‿dy:
  nx‿ny ← sz|(x+dx)‿(y+dy)
  nx‿ny‿dx‿dy
}

c  ← <˘2⊸↑˘M⍟100˘in
e  ← +´{+⟜1⌾((⌽𝕩)⊸⊑) ⍉sz⥊0}¨c
Q  ← {w‿h𝕊𝕩: w↑⌾⍉h↑𝕩}

star1 ← ×´(+´+˝)¨{h Q 𝕏e}¨⟨⊢,⌽˘,⌽,⌽⌽⌾⍉⟩

# star 2 finding code
# from ← 0
# e    ↩ sz⥊0
# s    ← M⍟from˘in
# i    ↩ from
# 
# {𝕊:
#   c ← <˘2⊸↑˘s
#   e ← +´{+⟜1⌾((⌽𝕩)⊸⊑) ⍉sz⥊0}¨c
#   •Show i
#   •Show " ************"⊏˜e
#   •Delay 0.05
#   i ↩ i + 1
#   s ↩ M˘s
# }•_while_(1) @

M⍟7344˘in
e ↩ +´{+⟜1⌾((⌽𝕩)⊸⊑) ⍉sz⥊0}¨<˘2⊸↑˘M⍟7344˘in
•Show " ************"⊏˜e
