in    â† â†‘â€¿2â¥Šâ€¢ParseFloatâˆ˜â‹ˆÂ¨âŠ‘â€¢FLines"9.in"
id    â† â‰(â‰in)âˆ¾Ëœâ†•âŠ‘â‰¢in
DoMap â† {âˆ¾â¥Š{ğ•Šidâ€¿fileâ€¿free: â‹ˆ(file/â‹ˆid)âˆ¾free/â‹ˆ'.'}Ë˜ğ•©}
map   â† DoMap id
moved â† {Â¯1â†“(Â¯1âŠ‘ğ•©)âŒ¾((âŠ‘/'.'âŠ¸=ğ•©)âŠ¸âŠ‘)ğ•©}âŸ(+Â´'.'=map) map

star1 â† +Â´Ã—Ë(â†•âˆ˜â‰ â‰âŠ¢)moved

# naive and uncleaned port from python solution for star2

id     â†© idâˆ¾âŒ¾â‰0â¥ŠËœâ‰ id
Mv     â† {tâ€¿fğ•Šğ•©: ((t+1)â†‘ğ•©)âˆ¾(fâŠğ•©)âˆ¾((1-Ëœf-t)â†‘(t+1)â†“ğ•©)âˆ¾((f+1)â†“ğ•©)}
bi â† c â† 1-Ëœâ‰ id
moved2 â† {ğ•Šğ•©:
  iâ€¿dâ€¿fâ€¿f2 â† ğ•©
  b â† biâŠ‘d
  {ğ•Šfbi: ((fbiâŠ‘f)â‰¥b) âˆ§ (fbi<bi) ?
    f2 +âŸœ((biâŠ‘d)+(biâŠ‘f))âŒ¾(biâŠ¸âŠ‘) â†©
    i fbiâ€¿biâŠ¸Mv â†©
    d fbiâ€¿biâŠ¸Mv â†©
    f fbiâ€¿biâŠ¸Mv â†©
    f ((fbiâŠ‘f)-b)âŒ¾((fbi+1)âŠ¸âŠ‘) â†©
    f 0âŒ¾(fbiâŠ¸âŠ‘) â†©
    bi +â†© 1
    @ ; ğ•©+1
  }â€¢_while_{ğ•©<â‰ f} 0
  bi -â†© 1
  c  -â†© 1
  iâ€¿dâ€¿fâ€¿f2
}â€¢_while_{ğ•Š: c>0} <Ë˜â‰id

DoMap2 â† {âˆ¾â¥Š{ğ•Šidâ€¿fileâ€¿free: â‹ˆ(file/â‹ˆid)âˆ¾free/â‹ˆ0}Ë˜ğ•©}
star2  â† +Â´Ã—Ë(â†•âˆ˜â‰ â‰âŠ¢) DoMap2â‰Â¯1â†“(â‰Ëœ+Ë)âŒ¾(2âŠ¸â†“) >moved2
