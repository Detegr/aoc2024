in    â† â†‘â€¿2â¥Šâ€¢ParseFloatâˆ˜â‹ˆÂ¨âŠ‘â€¢FLines"9.in"
id    â† â‰(â‰in)âˆ¾Ëœâ†•âŠ‘â‰¢in
DoMap â† {wâ†ğ•¨ â‹„ âˆ¾â¥Š{ğ•Šidâ€¿fileâ€¿free: â‹ˆ(file/â‹ˆid)âˆ¾free/â‹ˆw}Ë˜ğ•©}
map   â† '.' DoMap id
moved â† {Â¯1â†“(Â¯1âŠ‘ğ•©)âŒ¾((âŠ‘/'.'âŠ¸=ğ•©)âŠ¸âŠ‘)ğ•©}âŸ(+Â´'.'=map) map

star1 â† +Â´Ã—Ë(â†•âˆ˜â‰ â‰âŠ¢)moved

# port from python solution
# not the thing of beauty but works, *shrug*

id â†© idâˆ¾âŒ¾â‰0â¥ŠËœâ‰ id
Mv â† {tâ€¿fğ•Šğ•©: ((t+1)â†‘ğ•©)âˆ¾(fâŠğ•©)âˆ¾((1-Ëœf-t)â†‘(t+1)â†“ğ•©)âˆ¾((f+1)â†“ğ•©)}
bi â† c â† (â‰ id)-1
defrag â† {ğ•Šiâ€¿dâ€¿fâ€¿f2:
  b â† biâŠ‘d
  {ğ•Šfbi: (b â‰¤ fbiâŠ‘f) âˆ§ fbi<bi ?
    f2 (d +â—‹(biâŠ¸âŠ‘) f)âŒ¾(biâŠ¸âŠ‘) â†©
    iâ€¿dâ€¿f fbiâ€¿biâŠ¸MvÂ¨ â†©
    f (b -Ëœ fbiâŠ‘f)âŒ¾((fbi+1)âŠ¸âŠ‘) â†©
    f 0âŒ¾(fbiâŠ¸âŠ‘) â†©
    bi +â†© 1
    @ ; ğ•©+1
  }â€¢_while_{ğ•©<â‰ f} 0
  biâ€¿c -â†© 1
  iâ€¿dâ€¿fâ€¿f2
}â€¢_while_{ğ•Š: c>0} <Ë˜â‰id

star2  â† +Â´Ã—Ë(â†•âˆ˜â‰ â‰âŠ¢) 0 DoMapâ‰Â¯1â†“(â‰Ëœ+Ë)âŒ¾(2âŠ¸â†“) >defrag
